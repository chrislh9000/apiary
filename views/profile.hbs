<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- <span class="skype-button bubble" data-contact-id="{{user.skype}}" data-color="#800000"></span>
<span class="skype-chat" data-color-message="#800000"></span> -->
<script src="https://swc.cdn.skype.com/sdk/v1/sdk.min.js"></script>
<div class="container-fluid" >
<div class="profile-page">
  <br>
  <br>
  <div class="container fixed-bg2">
    {{#if successEdit}}
    <div style="text-align: center" class="alert alert-success" role="alert">
      <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
      {{successEdit}}
    </div>
    {{/if}}
    {{#if failureEdit}}
    <div style="text-align: center" class="alert alert-danger" role="alert">
      <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
      {{failureEdit}}
    </div>
    {{/if}}
    <h1 class="" style="text-align: center; font-family: 'Alegreya Sans SC', sans-serif; font-size: 45px; color: #"> {{user.name}} </h1>
    <br>
    <div class="row profile-container" style="min-height: 600px">
      <div style="overflow: auto" class="col-xs-12 col-sm-12 col-md-12 col-lg-7 center-block card">
        <br>
        {{#if image}}
        <img src="{{image}}" class="center-block" style="border: solid 2px #910000; width:200px; height:250px" />
        {{else}}
        <img src="/profiles/1535005509011-avatar1.jpg" class="center-block" style="border: solid 2px #910000; width:250px; height:250px" />
        {{/if}}
        {{#if owner}}
        <br>
        <center><button id="image-upload" class ="btn btn-primary" style= "color: #9e9e9e; font-family: 'Alegreya Sans SC', sans-serif;">Upload New Image</button></center>
        {{/if}}
        <h3 style="text-align: center; color: black; font-family: 'Montserrat', sans-serif; font-size: 22px;">{{user.email}}</h3>
        <h5 style="text-align: center; color: maroon; font-family: 'Montserrat', sans-serif; font-size: 22px;">{{user.school}}</h5>
        <h5 style="border-bottom: 0px solid gray; padding-bottom: 10px; text-align: center; color: maroon; font-family: 'Montserrat', sans-serif; font-size: 15px;">Nationality: {{user.country}}</h5>
        <div>
          <!-- Card One -->
          <div class="card">
            <div class="card-header apiary-collapsable" id="headingOne">
              <h5 class="mb-0">
                <button class="apiary-collapse-btn btn collapsed" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne" style = "font-size: 18px">
                  View {{user.name}}'s Biography and Interests
                </button>
              </h5>
            </div>

            <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordion">
              <div class="card-body">
                <h5 style="text-align: center; color: indianred; font-family: 'Montserrat', sans-serif; font-size: 18px;"> Biography </h5>
                <center><i style="color: black; font-family: 'Montserrat', sans-serif; font-size: 15px; text-style: "> {{user.biography}}</i> </center>
                <br><br>
                <h5 style="text-align: center; color: maroon; font-family: 'Montserrat', sans-serif; font-size: 18px;">  Academic Interests</h5>
                {{#each user.academicInterests}}
                <p style="text-align: center; color: black; font-family: 'Montserrat', sans-serif; font-size: 18px;">{{this}}</p>
                {{/each}}
                <br>
                <h5 style="text-align: center; color: indianred; font-family: 'Montserrat', sans-serif; font-size: 18px;">  Extracurricular Interests</h5>
                {{#each user.extracurricularInterests}}
                <p style="text-align: center; color: black; font-family: 'Montserrat', sans-serif; font-size: 18px;">{{this}}</p>
                {{/each}} <br>
                <h5 style="text-align: center; color: maroon; font-family: 'Montserrat', sans-serif; font-size: 18px;">  Intended Major </h5>
                <h5 style="text-align: center; color:black; font-family: 'Montserrat', sans-serif; font-size: 18px;"> {{user.intendedMajor}}</h5>
                <h5 style="text-align: center; color: indianred; font-family: 'Montserrat', sans-serif; font-size: 18px;">  Dream University </h5>
                <h5 style="text-align: center; color:black; font-family: 'Montserrat', sans-serif; font-size: 18px;"> {{user.dreamUni}}</h5>
                <br>
              </div>
            </div>
          </div>
          <!-- Card One -->
          <!-- Card Two -->
          <div class="card">
            <div class="card-header apiary-collapsable" id="headingThree">
              <h5 class="mb-0">
                <button class="apiary-collapse-btn btn collapsed" data-toggle="collapse" data-target="#collapseFour" aria-expanded="false" aria-controls="collapseThree" style = "font-size: 18px">
                  Contact {{user.name}}
                </button>
              </h5>
            </div>
            <div id="collapseFour" class="collapse" aria-labelledby="headingThree" data-parent="#accordion">
              <div class="card-body">
                    <h1 class = "bigTitleFont-black" style="text-align: center"> Email {{user.name}} </h1><br>
                    <form>
                      <input class="form-control" placeholder="Email Subject" />
                </div>
              </div>
            </div>
            <br>
            <div>
            <center> <a style="margin-bottom: 10px; font-family: 'Alegreya Sans SC', sans-serif; font-size: 14px; display: float;" class="btn apiary-button" href="/users/all">Go to the Apiary Network</a><br></center>
            {{#if owner}}
              <center><button data-toggle="modal" data-target="#edit-user-profile-modal" type="button" style="font-family: 'Alegreya Sans SC', sans-serif'; color: white" class="btn apiary-button">Edit Profile</button></center> <br>
            {{/if}}
            {{#if consultantPortal}}
            <center> <a style="margin-bottom: 10px; font-family: 'Alegreya Sans SC', sans-serif; font-size: 14px; display: float;" class="btn apiary-button" href="/consultants/profile">Consultant Portal</a></center>
            {{/if}}
            {{#if adminPortal}}
            <center> <a style="margin-bottom: 10px; font-family: 'Alegreya Sans SC', sans-serif; font-size: 14px; display: float;" class="btn apiary-button" href="/admin">Admin Page</a></center>
            {{/if}}
          </div>
          <!-- Card Two -->
      </div>
      </div>
    </div>
  </div>

  <br>

  <br>
</div>
</div>


<!-- Modals -->

<div class="modal fade bd-example-modal-lg" id="edit-user-profile-modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Edit User Profile</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form method="POST" action="/users/edit">
        <div class="limiter fixed-bg-sf">
        		<div class="container-login100 fixed-bg-sf">
        			<div class="wrap-login100 p-t-30 p-b-50">
        				<span class="login100-form-title p-b-41" style = "font-family: 'Montserrat', serif; font-size: 40px;">
                  <br>
                  <br>
        					Edit Profile
                  <br>
                  <br>
        				</span>
        				<form class="login100-form validate-form p-b-33 p-t-5">

        					<div class="wrap-input100 validate-input form-group" data-validate = "Enter firstname">
        						<input class="input100 " type="text" name="firstName" placeholder="FIRSTNAME" style = "font-family: 'Montserrat', serif; font-size: 20px; color: white;" value={{firstName}} required>
        						<span class="focus-input100" data-placeholder="	&#x1F58A;"></span>
        					</div>

        					<div class="wrap-input100 validate-input form-group" data-validate="Enter lastname">
        						<input class="input100" type="text" name="lastName" placeholder="LASTNAME" style = "font-family: 'Montserrat', serif; font-size: 20px; color: white;" value={{lastName}} required>
        						<span class="focus-input100" data-placeholder="	&#x1F58A;"></span>
        					</div>

                  <div class="wrap-input100 validate-input form-group" data-validate="Enter email">
        						<input class="input100" type="text" name="email" placeholder="E-MAIL" style = "font-family: 'Montserrat', serif; font-size: 20px; color: white;" value={{user.email}} required>
        						<span class="focus-input100" data-placeholder="	&#x1F4E7;"></span>
        					</div>

                  <div class="wrap-input100 validate-input form-group" data-validate="Enter school">
        						<input class="input100" type="text" name="school" placeholder="SCHOOL" style = "font-family: 'Montserrat', serif; font-size: 20px; color: white;" value='{{user.school}}' required>
        						<span class="focus-input100" data-placeholder="	&#x1F392;"></span>
        					</div>

                  <div class="wrap-input100 validate-input form-group" data-validate="Enter username">
        						<input class="input100" type="text" name="username" placeholder="USERNAME" style = "font-family: 'Montserrat', serif; font-size: 20px; color: white;" value={{user.username}} required>
        						<span class="focus-input100" data-placeholder="&#x1F464;"></span>
        					</div>

                  <div class="wrap-input100 validate-input form-group" data-validate="Enter biography">
        						<input class="input100" type="text" name="biography" rows = "3" placeholder="BIOGRAPHY" style = "font-family: 'Montserrat', serif; font-size: 20px; color: white;" value='{{user.biography}}' required>
        						<span class="focus-input100" data-placeholder="	&#x270D;"></span>
        					</div>
                  {{#if user.academicInterests}}
                  <div class="wrap-input100 validate-input form-group" data-validate="Enter your academic interests">
                    {{#each user.academicInterests}}
        						<input class="input100" type="text" name="interest{{@index}}" placeholder="FIRST ACADEMIC INTEREST" style = "font-family: 'Montserrat', serif; font-size: 17px; color: white;" value='{{this}}' required>
        						<span class="focus-input100" data-placeholder="	&#x1F913;"></span>
                    {{/each}}
        					</div>
                  {{else}}
                  <div class="wrap-input100 validate-input form-group" data-validate="Enter your academic interestes">
        						<input class="input100" type="text" name="interest0" placeholder="FIRST ACADEMIC INTEREST" style = "font-family: 'Montserrat', serif; font-size: 17px; color: white;" required>
        						<span class="focus-input100" data-placeholder="	&#x1F913;"></span>
                    <input class="input100" type="text" name="interest1" placeholder="SECOND ACADEMIC INTEREST" style = "font-family: 'Montserrat', serif; font-size: 17px; color: white;" required>
        						<span class="focus-input100" data-placeholder="	&#x1F913;"></span>
                    <input class="input100" type="text" name="interest2" placeholder="THIRD ACADEMIC INTEREST" style = "font-family: 'Montserrat', serif; font-size: 17px; color: white;" required>
        						<span class="focus-input100" data-placeholder="	&#x1F913;"></span>
        					</div>
                  {{/if}}

                  {{#if user.extracurricularInterests}}
                  <div class="wrap-input100 validate-input form-group" data-validate="Enter your extracurricular interests">
                    {{#each user.extracurricularInterests}}
        						<input class="input100" type="text" name="hobby{{@index}}" placeholder="FIRST HOBBY" style = "font-family: 'Montserrat', serif; font-size: 17px; color: white;" value='{{this}}' required>
        						<span class="focus-input100" data-placeholder="		&#x26BD;"></span>
                    {{/each}}
        					</div>
                  {{else}}
                  <div class="wrap-input100 validate-input form-group" data-validate="Enter your extracurricular interestes">
                    <input class="input100" type="text" name="hobby0" placeholder="FIRST HOBBY" style = "font-family: 'Montserrat', serif; font-size: 17px; color: white;" required>
                    <span class="focus-input100" data-placeholder="		&#x26BD;"></span>
                    <input class="input100" type="text" name="hobby1" placeholder="SECOND HOBBY" style = "font-family: 'Montserrat', serif; font-size: 17px; color: white;" required>
                    <span class="focus-input100" data-placeholder="		&#x26BD;"></span>
                    <input class="input100" type="text" name="hobbie2" placeholder="THIRD HOBBY" style = "font-family: 'Montserrat', serif; font-size: 17px; color: white;" required>
                    <span class="focus-input100" data-placeholder="		&#x26BD;"></span>
                  </div>
                  {{/if}}


                  <div class="wrap-input100 validate-input form-group" data-validate="Enter your intended major at university">
        						<input class="input100" type="text" name="intendedMajor" placeholder="INTENDED MAJOR" style = "font-family: 'Montserrat', serif; font-size: 20px; color: white;" value='{{user.intendedMajor}}'required>
        						<span class="focus-input100" data-placeholder="		&#x1F4D6;"></span>
        					</div>

                  <div class="wrap-input100 validate-input form-group" data-validate="Enter your dream university">
        						<input class="input100" type="text" name="dreamUni" placeholder="DREAM UNIVERSITY" style = "font-family: 'Montserrat', serif; font-size: 20px; color: white;" value='{{user.dreamUni}}' required>
        						<span class="focus-input100" data-placeholder="		&#x1F393;"></span>
        					</div>
        					<div class="container-login100-form-btn m-t-32 form-group">
        						<button class="login100-form-btn" style = "font-family: 'Montserrat', serif; font-size: 20px;">
        							Save Changes
        						</button>
        					</div>

        				</form>
        			</div>
        		</div>
        	</div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Modals -->

<script src="//widget.cloudinary.com/global/all.js" type="text/javascript"></script>
<script type="text/javascript">

$('#image-upload').cloudinary_upload_widget(
  { cloud_name: 'apiary-solutions', upload_preset: 'test_upload',
  cropping: 'server', folder: 'ambassador_profiles' },
  (error, result) => {
    var imageInfo = result[0]
    console.log(error, result);
    $.ajax({
      url: 'http://localhost:3000/images/information',
      type:'POST',
      data: {
        filename: imageInfo.original_filename,
        size: imageInfo.bytes,
        type: imageInfo.format,
        cloudinaryUrl: imageInfo.url,
        cloudinaryThumbnail: imageInfo.thumbnail_url,
      },
      success: (response) => {
        console.log(response);
        window.location.href= "http://localhost:3000/ambassadors/myProfile?image=success"
      },
      error: (resp) => {
        alert('incorrect input fields');
      }
    })
  });

  $('.cloudinary-button').text('Update Profile Picture')
  </script>
